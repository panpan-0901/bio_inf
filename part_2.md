# 序列比对
**生物-数据-模型-算法**  
如何比对两条序列？  
空位‘ ’，代表序列的插入或删除  ；‘：’代表替换前后相似程度，比较相似；‘.’代表不太相似，‘|’代表完全相同   
分数矩阵：**对称，上下文无关**，其中空位为负分，冒号为正分，点号为负分，竖号为正分   
仿射空位罚分：出现一个空位就会得到一个d，扩展一个空位得到一个e，n为空位长度，故总得分=d + (n - 1)* e  
最终得分 = 替代得分 + (-1) * 仿射空位得分
## 算法
### 动态规划
输入数据：一对序列(S1,S2)  
打分函数f——替代得分和仿射空位罚分  
输出：arg max (f(ali(S1,S2)))  
打分分数固定，若长度也固定，则通过枚举可以得到结果，但由于计算，枚举不可行  
**一对基因之间的组合得到最优，进而推广到全局**  
&emsp;&emsp;&emsp; &emsp;&emsp;&emsp;F(i - 1,j - 1) + s(xi,yj) 前面所有最优+最后一个位置最优  
F(i,j) = max &emsp;F(i - 1,j) + d    在第一个基因上插入空格  
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;F(i,j - 1) + d    在第二个序列上插入空格 
#### 考虑仿射空位罚分
前面未考虑gap open（d）和gap extension(e)，现在考虑，可以将序列分为三种状态M、X和Y（状态转移），其中M代表无空位，X代表X链对应为空，Y代表Y链对应为空。故X、Y、M可以自身向自身转换，即M下一个继续是M，X和Y扩展空位；X、Y可与M相互转换，X、Y到M即后一位变为无空位状态，M到X即X链对应的Y链出现空位，M到Y即Y链对应的X链出现空位。  
通过对状态转移做一个矩阵列表，也即动态规划中的矩阵列表，便可推出其复杂度为O（n²）